CREATE DATABASE QLKS23
USE QLKS23

--TẠO BẢNG NHÂN VIÊN
CREATE TABLE NHANVIEN(
MANHANVIEN CHAR(10) NOT NULL PRIMARY KEY,
MATKHAU VARCHAR(20) NOT NULL,
HOTEN NVARCHAR(100) NOT NULL,
NGAYSINH DATE NOT NULL,
GIOITINH BIT NOT NULL ,
DIACHI NVARCHAR(100) NOT NULL,
SODIENTHOAI VARCHAR(20),
NGAYVAOLAM DATE NOT NULL,
);

INSERT INTO NHANVIEN
VALUES 
('NV01','123456',N'Nguyễn Thị Nụ','10/11/2000',1,N'Đống Đa-Hà Nội','0973287666','11/9/2020'),
('NV02','123456',N'Trần Văn Sang','1/1/2000',0,N'Thanh Trì-Hà Nội','0972873536','11/11/2020'),
('NV03','123456',N'Trần Tuấn Anh','1/20/2001',0,N'Hoàn Kiếm-Hà Nội','0273347611','11/1/2021'),
('NV04','123456',N'Nguyễn Thế Anh','3/2/1999',0,N'Nam Từ Liêm- Hà Nội','0273287666','11/2/2021'),
('NV05','123456',N'Lê Thị Thúy','1/2/2001',1,N'Cầu Giấy- Hà Nội','0973287999','11/12/2021');


--TẠO BẢNG KHACHHANG
CREATE TABLE KHACHHANG(
MAKHACH CHAR(10) NOT NULL PRIMARY KEY,
HOTEN NVARCHAR(100) NOT NULL,
GIOITINH BIT,
DIACHI NVARCHAR(50),
CMND CHAR(12),
DIENTHOAI VARCHAR(10),
);

INSERT INTO KHACHHANG
VALUES
('K01',N'Lê Đức Sơn',1,N'Đà Nẵng','030301009999','0987654678'),
('K02',N'Nguyễn Văn Túy ',0,N'Đà Lạt','0303010000','0987654888'),
('K03',N'Nguyễn Thị Lê ',0,N'Đà Lạt','0303010232','0987652412'),
('K04',N'Nguyễn Thị Thúy An ',0,N'Đà Lạt','0303010099','0987654982'),
('K05',N'Trần Gia Khánh ',0,N'Đà Lạt','0303010988','0987654763'),
('K06',N'Lò Văn Hóa ',0,N'Đà Lạt','0303010123','0987654128'),
('K07',N'Vũ Toàn',0,N'Đà Lạt','0303010045','0987654123');

--TẠO BẢNG THIETBI
CREATE TABLE THIETBI
(
MATHIETBI CHAR(10) NOT NULL PRIMARY KEY,
TENTHIETBI NVARCHAR(50) NOT NULL,
DVT NVARCHAR(10),
GIATIEN MONEY NOT NULL,
);

INSERT INTO THIETBI
VALUES
('MTB01',N'Điều hòa',N'chiếc',400),
('MTB02',N'Tivi',N'chiếc',300),
('MTB03',N'Giường',N'chiếc',100),
('MTB04',N'Máy chơi game',N'chiếc',10),
('MTB05',N'Bình nóng lạnh',N'chiếc',500),
('MTB06',N'Đèn điện',N'chiếc',10),
('MTB07',N'Bàn',N'chiếc',20),
('MTB08',N'Ghế',N'chiếc',10);


-- TẠO BẢNG LOAIPHONG
CREATE TABLE LOAIPHONG(
MALOAIPHONG CHAR(10) NOT NULL PRIMARY KEY,
LOAIPHONG NVARCHAR(50) NOT NULL,
GIATIEN MONEY NOT NULL,
);
INSERT INTO LOAIPHONG
VALUES 
('MLP01',N'Phòng vip',50),
('MLP02',N'Phòng tầm trung',30),
('MLP03',N'Phòng thường',10);


--TẠO BẢNG PHONG
CREATE TABLE PHONG
(
MAPHONG CHAR(10) NOT NULL PRIMARY KEY,
MALOAIPHONG CHAR(10) NOT NULL,
TINHTRANG BIT,
CONSTRAINT KN_DMPHONG FOREIGN KEY (MALOAIPHONG) REFERENCES LOAIPHONG(MALOAIPHONG),
);
INSERT INTO PHONG
VALUES
('MP01','MLP01',1),
('MP02','MLP01',1),
('MP03','MLP01',1),
('MP04','MLP01',1),
('MP05','MLP01',1),
('MP06','MLP02',1),
('MP07','MLP02',1),
('MP08','MLP02',1),
('MP09','MLP02',1),
('MP10','MLP02',1),
('MP11','MLP03',1),
('MP12','MLP03',1),
('MP13','MLP03',1),
('MP14','MLP03',1),
('MP15','MLP03',0),
('MP17','MLP03',0),
('MP18','MLP03',0),
('MP19','MLP03',0),
('MP20','MLP03',0),
('MP21','MLP03',0),
('MP22','MLP03',0),
('MP23','MLP03',0),
('MP24','MLP03',0);


--TẠO BẢNG THIETBI_PHONG
CREATE TABLE THIETBI_PHONG
(
MAPHONG CHAR(10) NOT NULL,
MATHIETBI CHAR(10) NOT NULL,
SOLUONG INT NOT NULL,
CONSTRAINT KC_THIETBI_PHONG PRIMARY KEY (MAPHONG,MATHIETBI),
CONSTRAINT KN_THIETBI_PHONG_MALOAIPHONG FOREIGN KEY (MAPHONG) REFERENCES PHONG(MAPHONG),
CONSTRAINT KN_THIETBI_PHONG_MATHIETBI FOREIGN KEY (MATHIETBI) REFERENCES THIETBI(MATHIETBI),
);

INSERT INTO THIETBI_PHONG
VALUES
('MP01','MTB01',2),
('MP01','MTB02',1),
('MP01','MTB03',1),
('MP01','MTB04',1),
('MP02','MTB05',1),
('MP02','MTB01',1),
('MP02','MTB02',1),
('MP02','MTB03',1),
('MP02','MTB06',1),
('MP03','MTB01',2),
('MP03','MTB03',1),
('MP03','MTB04',2),
('MP03','MTB05',1),
('MP03','MTB06',2),
('MP03','MTB07',1);


--TẠO BẢNG HÓA ĐƠN THUÊ PHÒNG
CREATE TABLE HDTHUEPHONG (
SHDTHUEPHONG NUMERIC IDENTITY(1,1) PRIMARY KEY,
MANHANVIEN CHAR(10) NOT NULL,
MAKHACH CHAR(10) NOT NULL,
MAPHONG CHAR(10) NOT NULL,
NGAYTHUE DATE NOT NULL,
NGAYTRA DATE,
CONSTRAINT KN_THUEPHONG_MANHANVIEN FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN),
CONSTRAINT KN_THUEPHONG_MAKHACH FOREIGN KEY (MAKHACH) REFERENCES KHACHHANG(MAKHACH),
CONSTRAINT KN_THUEPHONG_MAPHONG FOREIGN KEY (MAPHONG) REFERENCES PHONG(MAPHONG),
);

INSERT INTO HDTHUEPHONG(MANHANVIEN,MAKHACH, MAPHONG, NGAYTHUE,NGAYTRA)
VALUES
('NV01','K01','MP01','10/12/2021','1/1/2022'),
('NV02','K02','MP02','11/24/2021','1/9/2022'),
('NV03','K03','MP03','11/24/2021','11/1/2022'),
('NV04','K04','MP04','11/25/2021','1/2/2022'),
('NV03','K05','MP05','11/26/2021','12/26/2021'),
('NV02','K06','MP06','12/22/2021','1/1/2022'),
('NV01','K07','MP07','12/23/2021','1/23/2022'),
('NV01','K01','MP08','12/23/2021','1/23/2022'),
('NV04','K03','MP09','12/23/2021','1/23/2022'),
('NV01','K03','MP10','12/24/2021','1/24/2022'),
('NV02','K04','MP11','12/24/2021','1/24/2022'),
('NV03','K04','MP12','12/25/2021','1/25/2022'),
('NV04','K05','MP13','12/25/2021','1/25/2022'),
('NV05','K01','MP14','12/26/2021','1/26/2022');



--TẠO BẢNG HDTHANHTOANPHONG
CREATE TABLE HDTHANHTOANPHONG
(
SHDTHANHTOAN NUMERIC IDENTITY(1,1) PRIMARY KEY,
SHDTHUEPHONG NUMERIC  NOT NULL,
MANHANVIEN CHAR(10) NOT NULL,
NGAYTHANHTOAN DATE NOT NULL,
TIENPHONG MONEY NOT NULL,
CONSTRAINT KN_HDTHANHTOANPHONG_SHDTHUEPHONG FOREIGN KEY (SHDTHUEPHONG) REFERENCES HDTHUEPHONG(SHDTHUEPHONG),
CONSTRAINT KN_HDTHANHTOANPHONG_MANHANVIEN FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN),
);

INSERT INTO HDTHANHTOANPHONG(SHDTHUEPHONG, MANHANVIEN,NGAYTHANHTOAN, TIENPHONG)
VALUES
(1, 'NV01','1/1/2022',200),
(2, 'NV02','1/9/2022',200),
(3, 'NV03','11/1/2022',200),
(4, 'NV04','1/2/2022',200),
(6, 'NV01','1/1/2022',200);